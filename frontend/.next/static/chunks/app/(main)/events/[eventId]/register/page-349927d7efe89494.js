(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[773],{230:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(6057),n=s(9806),a=s(8050),i=s(2246),l=s(9828);let d="https://api.infps-demo.com/api",o=i.A.create({baseURL:d,withCredentials:!0,headers:{"Content-Type":"application/json"}});function c(e){let{bodyType:t="json",endpoint:s,exact:i=!0,queryKey:l=[],method:c="GET",params:m,headers:u,enabled:x=!0,onSuccess:h,onError:p,baseUrl:f,queryString:g,invalidateKeys:v}=e,b=(0,r.jE)(),y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let r={method:c,url:null!=s?s:"",baseURL:null!=f?f:d,headers:u?{...u}:void 0,params:m};g&&(r.url="".concat(r.url,"?").concat(g)),e&&"GET"!==c&&("formdata"===t?(r.data=e,r.headers={...r.headers,"Content-Type":"multipart/form-data"}):r.data=e);let n=await o.request(r);return{data:n.data,status:n.status}}catch(t){var r,n,a,i,l;let e=(null==(r=t.response)?void 0:r.status)||500;return{error:(null==(a=t.response)||null==(n=a.data)?void 0:n.error)||(null==(l=t.response)||null==(i=l.data)?void 0:i.message)||t.message||"Internal error",status:e}}};if(x&&"GET"===c){var j;let e=(0,n.I)({queryKey:l,queryFn:()=>y(),refetchOnWindowFocus:!1,retry:(e,t)=>(null==t?void 0:t.status)!==401&&(null==t?void 0:t.status)!==403&&e<3,refetchOnReconnect:!1,staleTime:1/0});return{data:null==(j=e.data)?void 0:j.data,error:e.error,isPending:e.isPending,isError:e.isError,isSuccess:e.isSuccess}}let{data:N,error:w,mutate:P,mutateAsync:E,isPending:S,isSuccess:A,isError:I,reset:T}=(0,a.n)({mutationFn:async e=>{let t=await y(e);if(t.error)throw Error(t.error,{cause:t.status});return t},onSuccess:async e=>{if([200,201,204].includes(e.status)){if(l.length&&b.invalidateQueries({queryKey:l,exact:i}),null==v?void 0:v.length)for(let e of v)b.invalidateQueries(e);null==h||h()}},onError:e=>{let t={message:e.message||"An error occurred",name:e.name||"Error",cause:e.cause,stack:e.stack};null==p||p(t)}});return{data:null==N?void 0:N.data,error:w,isPending:S,isError:I,isSuccess:A,mutate:P,mutateAsync:E,reset:T}}o.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),o.interceptors.response.use(e=>e,e=>{var t;if((null==(t=e.response)?void 0:t.status)===401){let e=window.location.pathname;if(!e.includes("/login")&&!e.includes("/signup")){let{clearAuth:e}=l.n.getState();e(),localStorage.removeItem("accessToken"),window.location.href="/login"}}return Promise.reject(e)})},2069:(e,t,s)=>{"use strict";s.d(t,{cn:()=>a});var r=s(418),n=s(3750);function a(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.QP)((0,r.$)(t))}},2403:(e,t,s)=>{"use strict";s.d(t,{p:()=>a});var r=s(13);s(6662);var n=s(2069);function a(e){let{className:t,type:s,...a}=e;return(0,r.jsx)("input",{type:s,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...a})}},3098:(e,t,s)=>{"use strict";s.d(t,{So:()=>i,Wn:()=>l,vz:()=>a,wV:()=>d});var r=s(230),n=s(5772);function a(){return(0,r.A)({endpoint:n.b.auth.login,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function i(){return(0,r.A)({endpoint:n.b.auth.signup,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function l(){return(0,r.A)({endpoint:n.b.auth.logout,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function d(){return(0,r.A)({endpoint:n.b.auth.session,method:"GET",queryKey:["session"]})}},3177:(e,t,s)=>{"use strict";s.d(t,{J:()=>i});var r=s(13);s(6662);var n=s(3539),a=s(2069);function i(e){let{className:t,...s}=e;return(0,r.jsx)(n.b,{"data-slot":"label",className:(0,a.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}},3984:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(13),n=s(6219),a=s(2403),i=s(3177),l=s(6231),d=s(9468),o=s(7568),c=s(230),m=s(5772),u=s(9828),x=s(983),h=s(6662),p=s(8688),f=s(7866);function g(e){let{params:t}=e,{eventId:s}=(0,h.use)(t);return(0,r.jsx)(n.AuthProvider,{requireAuth:!0,children:(0,r.jsx)(v,{eventId:s})})}function v(e){let{eventId:t}=e,[s,n]=(0,h.useState)([]),{data:a,isError:i,error:l,isPending:o}=(0,d.Gq)(t);if(o)return(0,r.jsx)("div",{children:"Loading..."});if(i)return(0,r.jsxs)("div",{children:["Error: ",l.message]});let c=null==a?void 0:a.data;return"OPEN"!==c.status?(0,r.jsx)("div",{className:"h-40 flex items-center justify-center",children:"Event is not open for registration"}):(0,r.jsxs)("div",{className:"min-h-screen",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-white to-primary h-48 flex items-center px-4 sm:px-6 lg:px-10 sm:h-64 lg:h-96 relative overflow-hidden",children:(0,r.jsx)("div",{className:"max-w-2xl relative z-10",children:(0,r.jsx)("h1",{className:"text-lg sm:text-2xl md:text-3xl lg:text-5xl font-semibold tracking-wider uppercase leading-tight",children:"Chasing the sky one feather at a time"})})}),(0,r.jsx)(N,{event:c}),(0,r.jsx)("div",{className:"bg-gradient-to-r from-primary to-white text-center",children:(0,r.jsx)("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold mb-4 py-4 text-white px-4",children:c.name})}),(0,r.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)(j,{}),(0,r.jsx)(y,{selectedBirds:s,setSelectedBirds:n}),s.length>0&&(0,r.jsx)(b,{event:c,selectedBirds:s})]})]})}function b(e){let{event:t,selectedBirds:s}=e,n=t.feeSchema.entryFee*s.length;return(0,r.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 xl:p-10 w-full border-t bg-gray-50",children:[(0,r.jsx)("h2",{className:"font-bold text-secondary mb-6 text-xl sm:text-2xl md:text-3xl lg:text-4xl",children:"Payment Information"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 sm:p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,r.jsx)("span",{className:"text-gray-600 text-sm sm:text-base",children:"Entry Fee per Bird:"}),(0,r.jsxs)("span",{className:"font-medium text-sm sm:text-base",children:["$",t.feeSchema.entryFee.toFixed(2)]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 border-b",children:[(0,r.jsx)("span",{className:"text-gray-600 text-sm sm:text-base",children:"Number of Birds:"}),(0,r.jsx)("span",{className:"font-medium text-sm sm:text-base",children:s.length})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center py-3 border-b-2 border-secondary",children:[(0,r.jsx)("span",{className:"text-base sm:text-lg font-semibold text-secondary",children:"Total Amount:"}),(0,r.jsxs)("span",{className:"text-lg sm:text-xl font-bold text-secondary",children:["$",n.toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-700 mb-3 text-sm sm:text-base",children:"Registered Birds:"}),(0,r.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-2",children:s.map((e,s)=>(0,r.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded text-sm",children:[(0,r.jsxs)("span",{className:"flex-1 truncate",children:[s+1,". ",e.birdName," - (",e.color,")"]}),(0,r.jsxs)("span",{className:"font-medium text-green-600 ml-2",children:["$",t.feeSchema.entryFee.toFixed(2)]})]},e.id))})]}),(0,r.jsx)("div",{className:"mt-8 flex w-full justify-center",children:(0,r.jsx)("div",{className:"w-full max-w-md",children:(0,r.jsx)(w,{eventId:t.id,selectedBirds:s})})}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Secure payment processing • All payments are encrypted and secure"})})]})]})}function y(e){let{selectedBirds:t,setSelectedBirds:s}=e,{data:n}=(0,l.wz)(),a=(null==n?void 0:n.data)||[];return(0,r.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 xl:p-10 w-full border-b",children:[(0,r.jsx)("h2",{className:"font-bold text-secondary mb-4 text-xl sm:text-2xl md:text-3xl lg:text-4xl",children:"Bird Information"}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Select Birds to Register"}),0===a.length?(0,r.jsx)("p",{className:"text-gray-500",children:"No birds available. Please add birds to your account first."}):(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>{let n=t.find(t=>t.id===e.id);return(0,r.jsx)("div",{className:"border rounded-lg p-4 cursor-pointer transition-all ".concat(n?"border-primary bg-primary/5":"border-gray-200 hover:border-primary/50"),onClick:()=>{t.find(t=>t.id===e.id)?p.o.info("".concat(e.birdName," is already selected")):(s([...t,e]),p.o.success("".concat(e.birdName," added to registration")))},children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.birdName}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Color: ",e.color]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Sex: ",e.sex]})]}),n&&(0,r.jsx)("div",{className:"text-primary text-sm font-medium",children:"✓ Selected"})]})},e.id)})})]}),t.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Selected Birds (",t.length,")"]}),(0,r.jsx)("button",{onClick:()=>{s([]),p.o.success("All birds removed from registration")},className:"text-red-600 hover:text-red-800 text-sm font-medium px-3 py-1 border border-red-200 rounded hover:bg-red-50 transition-colors",children:"Clear All"})]}),(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.birdName}),(0,r.jsxs)("div",{className:"flex gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["Color: ",e.color]}),(0,r.jsxs)("span",{children:["Sex: ",e.sex]})]})]}),(0,r.jsx)("button",{onClick:()=>(e=>{let r=t.find(t=>t.id===e);s(t.filter(t=>t.id!==e)),r&&p.o.success("".concat(r.birdName," removed from registration"))})(e.id),className:"text-red-600 hover:text-red-800 text-sm font-medium px-3 py-1 border border-red-200 rounded hover:bg-red-50 transition-colors ml-4",children:"Remove"})]},e.id))})]})]})}function j(){let{user:e}=(0,u.n)();return(0,r.jsxs)("div",{className:"p-4 sm:p-6 lg:p-8 xl:p-10 w-full border-b",children:[(0,r.jsx)("h2",{className:"font-bold text-secondary mb-4 text-xl sm:text-2xl md:text-3xl lg:text-4xl",children:"Owner Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(i.J,{className:"text-sm font-medium",children:"Name"}),(0,r.jsx)(a.p,{value:(null==e?void 0:e.name)||"",className:"mt-2 h-10 sm:h-12 shadow-none",readOnly:!0,disabled:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(i.J,{className:"text-sm font-medium",children:"Email"}),(0,r.jsx)(a.p,{value:(null==e?void 0:e.email)||"",className:"mt-2 h-10 sm:h-12 shadow-none",readOnly:!0,disabled:!0})]})]})]})}function N(e){let{event:t}=e,[s,n]=(0,h.useState)({hours:0,minutes:0,seconds:0});return(0,h.useEffect)(()=>{if(!(null==t?void 0:t.date))return;let e=()=>{let e=new Date().getTime(),s=new Date(t.date).getTime()-e;if(s>0){let e=Math.floor(s/36e5);n({hours:e,minutes:Math.floor(s%36e5/6e4),seconds:Math.floor(s%6e4/1e3)})}else n({hours:0,minutes:0,seconds:0})};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[null==t?void 0:t.date]),(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-6 p-4 sm:p-6 lg:p-8 xl:p-10",children:[(0,r.jsxs)("div",{className:"border-r px-2 sm:px-4 lg:px-10 text-center",children:[(0,r.jsx)("p",{className:"text-lg sm:text-2xl font-bold mb-2 sm:mb-4",children:t._count.EventInventoryItem}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Total Registrations"})]}),(0,r.jsxs)("div",{className:"border-r px-2 sm:px-4 lg:px-10 text-center",children:[(0,r.jsx)("p",{className:"text-lg sm:text-2xl font-bold mb-2 sm:mb-4",children:s.hours}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Hours"})]}),(0,r.jsxs)("div",{className:"border-r px-2 sm:px-4 lg:px-10 text-center",children:[(0,r.jsx)("p",{className:"text-lg sm:text-2xl font-bold mb-2 sm:mb-4",children:s.minutes}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Minutes"})]}),(0,r.jsxs)("div",{className:"px-2 sm:px-4 lg:px-10 text-center",children:[(0,r.jsx)("p",{className:"text-lg sm:text-2xl font-bold mb-2 sm:mb-4",children:s.seconds}),(0,r.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:"Seconds"})]})]})}function w(e){let{eventId:t,selectedBirds:s}=e,[n,a]=(0,h.useState)(!1),{mutateAsync:i,isPending:l}=(0,o.W)(),{mutateAsync:d,isPending:u}=(0,c.A)({endpoint:m.b.payment.capture,method:"POST",invalidateKeys:[{queryKey:["payments"]}]}),g=(0,x.useRouter)(),v="AfsYpe1yqzpNlMmzK1tMp7yA9E0SHdNVpCTv1MkItfETK5VI6jmfFKde6ZmbpmSx83IWPX0jcNug3tTE";if(!v)return(0,r.jsx)("div",{className:"text-center p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-600 text-sm",children:"Payment system is temporarily unavailable"})});async function b(){try{var e;if(a(!0),!i)throw Error("Registration service unavailable");if(0===s.length)throw Error("No birds selected for registration");let r=s.map(e=>e.id),{data:n,error:l}=await i({birds:r,eventId:t});if(l)throw p.o.error(l),Error("Failed to create order: "+l);let d=null==n||null==(e=n.data)?void 0:e.orderId;if(!d)throw Error("No order ID received");return p.o.info("Order created successfully"),d}catch(e){throw console.error("Error creating order:",e),p.o.error(e.message||"Failed to create order"),a(!1),e}}async function y(e){try{if(console.log("PayPal approval data:",e),!e.orderID)throw Error("No order ID provided by PayPal");let{orderID:t}=e;if(p.o.info("Processing payment..."),!d)throw Error("Payment capture service unavailable");let{data:s,error:r}=await d({orderId:t});if(r)throw console.error("Error capturing payment:",r),Error("Payment capture failed: "+r);console.log("Payment captured successfully:",s),p.o.success("Payment successful! Registration complete."),setTimeout(()=>{g.push("/profile/my-events")},2e3)}catch(e){console.error("Error during payment capture:",e)}finally{a(!1)}}async function j(e){console.error("PayPal Button Error:",e),a(!1);let t="Payment failed. Please try again.";(null==e?void 0:e.message)?t=e.message:"string"==typeof e&&(t=e),p.o.error(t)}let N=n||l||u;return(0,r.jsxs)("div",{className:"w-full",children:[N&&(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsxs)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-blue-600 mr-2"}),l?"Creating order...":u?"Processing payment...":"Processing..."]})}),(0,r.jsx)(f.ag,{options:{clientId:v,currency:"USD",intent:"capture"},children:(0,r.jsx)(f.JV,{style:{layout:"vertical",color:"blue",shape:"rect",height:45},createOrder:b,onApprove:y,onError:j,onCancel:function(e){console.log("PayPal payment cancelled:",e),a(!1),p.o.info("Payment cancelled")},fundingSource:"paypal",disabled:N})}),(0,r.jsx)("div",{className:"mt-3 text-center",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"You will be redirected to your race registrations after successful payment"})})]})}},5772:(e,t,s)=>{"use strict";s.d(t,{b:()=>r});let r={auth:{login:"/auth/breeder/login",logout:"/auth/breeder/logout",signup:"/auth/breeder/signup",session:"/auth/session"},user:{currentUser:"/users/profile"},birds:{all:"/birds",create:"/birds",update:e=>"/birds/".concat(e)},events:{all:"/events",byId:e=>"/events/".concat(e),more:e=>"/events/".concat(e,"/more")},eventInventory:{create:"/event-inventory",getmyevents:"/event-inventory/my-events"},payment:{capture:"/payments/capture"}}},6219:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>d});var r=s(13),n=s(6662),a=s(983),i=s(9828),l=s(3098);function d(e){let{children:t,requireAuth:s=!1,redirectTo:d="/login"}=e,o=(0,a.useRouter)(),{user:c,isAuthenticated:m,isLoading:u,setUser:x}=(0,i.n)(),{data:h,isError:p,isPending:f}=(0,l.wV)();return((0,n.useEffect)(()=>{f||((null==h?void 0:h.data)?x(h.data):i.n.getState().setLoading(!1))},[h,f,x]),(0,n.useEffect)(()=>{f||u||!s||m||o.push(d)},[s,m,f,u,o,d]),f||u)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s&&!m?null:(0,r.jsx)(r.Fragment,{children:t})}},6231:(e,t,s)=>{"use strict";s.d(t,{Sp:()=>l,fY:()=>i,wz:()=>a});var r=s(230),n=s(5772);function a(){return(0,r.A)({endpoint:n.b.birds.all,method:"GET",queryKey:["birds"]})}function i(){return(0,r.A)({endpoint:n.b.birds.create,method:"POST",invalidateKeys:[{queryKey:["birds"]}]})}function l(e){return(0,r.A)({endpoint:n.b.birds.update(e),method:"PUT",invalidateKeys:[{queryKey:["birds"]}]})}},7568:(e,t,s)=>{"use strict";s.d(t,{D:()=>a,W:()=>i});var r=s(230),n=s(5772);function a(){return(0,r.A)({endpoint:n.b.eventInventory.getmyevents,method:"GET",queryKey:["eventInventory"]})}function i(){return(0,r.A)({endpoint:n.b.eventInventory.create,method:"POST",invalidateKeys:[{queryKey:["eventInventory"]}]})}},7584:(e,t,s)=>{Promise.resolve().then(s.bind(s,3984))},9468:(e,t,s)=>{"use strict";s.d(t,{Gq:()=>i,KU:()=>l,NC:()=>a});var r=s(230),n=s(5772);function a(e){let{params:t}=e,s=t?Object.entries(t).map(e=>{let[t,s]=e;return"".concat(t,"=").concat(s)}).join("&"):"";return(0,r.A)({endpoint:n.b.events.all,params:t,queryKey:["events",s]})}function i(e){return(0,r.A)({endpoint:n.b.events.byId(e),queryKey:["event",e]})}function l(e){let{id:t,params:s}=e,a=s?Object.entries(s).map(e=>{let[t,s]=e;return"".concat(t,"=").concat(s)}).join("&"):"";return(0,r.A)({endpoint:n.b.events.more(t),params:s,queryKey:["more-events",t,a]})}},9828:(e,t,s)=>{"use strict";s.d(t,{n:()=>r});let r=(0,s(9568).v)()((e,t)=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:t=>e({user:t,isAuthenticated:!!t,isLoading:!1}),clearAuth:()=>{localStorage.removeItem("accessToken"),e({user:null,isAuthenticated:!1,isLoading:!1})},setLoading:t=>e({isLoading:t}),checkAuthFromStorage:()=>!!localStorage.getItem("accessToken")}))}},e=>{e.O(0,[46,616,219,688,116,1,540,358],()=>e(e.s=7584)),_N_E=e.O()}]);