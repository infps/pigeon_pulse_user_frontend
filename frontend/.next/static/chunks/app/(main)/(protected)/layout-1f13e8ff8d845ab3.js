(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{12:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(13),s=n(6219);function a(e){let{children:t}=e;return(0,r.jsx)(s.AuthProvider,{requireAuth:!0,children:(0,r.jsx)("div",{children:t})})}},230:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(6057),s=n(9806),a=n(8050),o=n(2246),u=n(9828);let i="https://api.infps-demo.com/api",l=o.A.create({baseURL:i,withCredentials:!0,headers:{"Content-Type":"application/json"}});function c(e){let{bodyType:t="json",endpoint:n,exact:o=!0,queryKey:u=[],method:c="GET",params:d,headers:h,enabled:v=!0,onSuccess:m,onError:g,baseUrl:p,queryString:f,invalidateKeys:y}=e,b=(0,r.jE)(),A=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let r={method:c,url:null!=n?n:"",baseURL:null!=p?p:i,headers:h?{...h}:void 0,params:d};f&&(r.url="".concat(r.url,"?").concat(f)),e&&"GET"!==c&&("formdata"===t?(r.data=e,r.headers={...r.headers,"Content-Type":"multipart/form-data"}):r.data=e);let s=await l.request(r);return{data:s.data,status:s.status}}catch(t){var r,s,a,o,u;let e=(null==(r=t.response)?void 0:r.status)||500;return{error:(null==(a=t.response)||null==(s=a.data)?void 0:s.error)||(null==(u=t.response)||null==(o=u.data)?void 0:o.message)||t.message||"Internal error",status:e}}};if(v&&"GET"===c){var E;let e=(0,s.I)({queryKey:u,queryFn:()=>A(),refetchOnWindowFocus:!1,retry:(e,t)=>(null==t?void 0:t.status)!==401&&(null==t?void 0:t.status)!==403&&e<3,refetchOnReconnect:!1,staleTime:1/0});return{data:null==(E=e.data)?void 0:E.data,error:e.error,isPending:e.isPending,isError:e.isError,isSuccess:e.isSuccess}}let{data:w,error:S,mutate:T,mutateAsync:P,isPending:j,isSuccess:k,isError:q,reset:I}=(0,a.n)({mutationFn:async e=>{let t=await A(e);if(t.error)throw Error(t.error,{cause:t.status});return t},onSuccess:async e=>{if([200,201,204].includes(e.status)){if(u.length&&b.invalidateQueries({queryKey:u,exact:o}),null==y?void 0:y.length)for(let e of y)b.invalidateQueries(e);null==m||m()}},onError:e=>{let t={message:e.message||"An error occurred",name:e.name||"Error",cause:e.cause,stack:e.stack};null==g||g(t)}});return{data:null==w?void 0:w.data,error:S,isPending:j,isError:q,isSuccess:k,mutate:T,mutateAsync:P,reset:I}}l.interceptors.request.use(e=>{{let t=localStorage.getItem("accessToken");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>{var t;if((null==(t=e.response)?void 0:t.status)===401){let e=window.location.pathname;if(!e.includes("/login")&&!e.includes("/signup")){let{clearAuth:e}=u.n.getState();e(),localStorage.removeItem("accessToken"),window.location.href="/login"}}return Promise.reject(e)})},983:(e,t,n)=>{"use strict";var r=n(6495);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},3098:(e,t,n)=>{"use strict";n.d(t,{So:()=>o,Wn:()=>u,vz:()=>a,wV:()=>i});var r=n(230),s=n(5772);function a(){return(0,r.A)({endpoint:s.b.auth.login,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function o(){return(0,r.A)({endpoint:s.b.auth.signup,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function u(){return(0,r.A)({endpoint:s.b.auth.logout,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function i(){return(0,r.A)({endpoint:s.b.auth.session,method:"GET",queryKey:["session"]})}},3405:(e,t,n)=>{Promise.resolve().then(n.bind(n,12))},5772:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});let r={auth:{login:"/auth/breeder/login",logout:"/auth/breeder/logout",signup:"/auth/breeder/signup",session:"/auth/session"},user:{currentUser:"/users/profile"},birds:{all:"/birds",create:"/birds",update:e=>"/birds/".concat(e)},events:{all:"/events",byId:e=>"/events/".concat(e),more:e=>"/events/".concat(e,"/more")},eventInventory:{create:"/event-inventory",getmyevents:"/event-inventory/my-events"},payment:{capture:"/payments/capture"}}},6219:(e,t,n)=>{"use strict";n.d(t,{AuthProvider:()=>i});var r=n(13),s=n(6662),a=n(983),o=n(9828),u=n(3098);function i(e){let{children:t,requireAuth:n=!1,redirectTo:i="/login"}=e,l=(0,a.useRouter)(),{user:c,isAuthenticated:d,isLoading:h,setUser:v}=(0,o.n)(),{data:m,isError:g,isPending:p}=(0,u.wV)();return((0,s.useEffect)(()=>{p||((null==m?void 0:m.data)?v(m.data):o.n.getState().setLoading(!1))},[m,p,v]),(0,s.useEffect)(()=>{p||h||!n||d||l.push(i)},[n,d,p,h,l,i]),p||h)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n&&!d?null:(0,r.jsx)(r.Fragment,{children:t})}},9828:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});let r=(0,n(9568).v)()((e,t)=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:t=>e({user:t,isAuthenticated:!!t,isLoading:!1}),clearAuth:()=>{localStorage.removeItem("accessToken"),e({user:null,isAuthenticated:!1,isLoading:!1})},setLoading:t=>e({isLoading:t}),checkAuthFromStorage:()=>!!localStorage.getItem("accessToken")}))}},e=>{e.O(0,[46,616,1,540,358],()=>e(e.s=3405)),_N_E=e.O()}]);