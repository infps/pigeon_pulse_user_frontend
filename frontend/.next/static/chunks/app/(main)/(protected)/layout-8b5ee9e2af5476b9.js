(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{12:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var r=n(13),s=n(6219);function a(e){let{children:t}=e;return(0,r.jsx)(s.AuthProvider,{requireAuth:!0,children:(0,r.jsx)("div",{children:t})})}},230:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var r=n(6057),s=n(9806),a=n(8050),i=n(2246),u=n(9828);let o="https://api.infps-demo.com/api",l=i.A.create({baseURL:o,withCredentials:!0,headers:{"Content-Type":"application/json"}});function d(e){let{bodyType:t="json",endpoint:n,exact:i=!0,queryKey:u=[],method:d="GET",params:c,headers:h,enabled:v=!0,onSuccess:m,onError:p,baseUrl:f,queryString:g,invalidateKeys:y}=e,b=(0,r.jE)(),E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let r={method:d,url:null!=n?n:"",baseURL:null!=f?f:o,headers:h?{...h}:void 0,params:c};g&&(r.url="".concat(r.url,"?").concat(g)),e&&"GET"!==d&&("formdata"===t?(r.data=e,r.headers={...r.headers,"Content-Type":"multipart/form-data"}):r.data=e);let s=await l.request(r);return{data:s.data,status:s.status}}catch(t){var r,s,a,i,u;let e=(null==(r=t.response)?void 0:r.status)||500;return{error:(null==(a=t.response)||null==(s=a.data)?void 0:s.error)||(null==(u=t.response)||null==(i=u.data)?void 0:i.message)||t.message||"Internal error",status:e}}};if(v&&"GET"===d){var w;let e=(0,s.I)({queryKey:u,queryFn:()=>E(),refetchOnWindowFocus:!1,retry:(e,t)=>(null==t?void 0:t.status)!==401&&(null==t?void 0:t.status)!==403&&e<3,refetchOnReconnect:!1,staleTime:1/0});return{data:null==(w=e.data)?void 0:w.data,error:e.error,isPending:e.isPending,isError:e.isError,isSuccess:e.isSuccess}}let{data:A,error:P,mutate:j,mutateAsync:T,isPending:S,isSuccess:L,isError:q,reset:K}=(0,a.n)({mutationFn:async e=>{let t=await E(e);if(t.error)throw Error(t.error,{cause:t.status});return t},onSuccess:async e=>{if([200,201,204].includes(e.status)){if(u.length&&b.invalidateQueries({queryKey:u,exact:i}),null==y?void 0:y.length)for(let e of y)b.invalidateQueries(e);null==m||m()}},onError:e=>{let t={message:e.message||"An error occurred",name:e.name||"Error",cause:e.cause,stack:e.stack};null==p||p(t)}});return{data:null==A?void 0:A.data,error:P,isPending:S,isError:q,isSuccess:L,mutate:j,mutateAsync:T,reset:K}}l.interceptors.response.use(e=>e,e=>{var t;if((null==(t=e.response)?void 0:t.status)===401){let e=window.location.pathname;if(!e.includes("/login")&&!e.includes("/signup")){let{clearAuth:e}=u.n.getState();e(),window.location.href="/login"}}return Promise.reject(e)})},983:(e,t,n)=>{"use strict";var r=n(6495);n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}})},3098:(e,t,n)=>{"use strict";n.d(t,{So:()=>i,Wn:()=>u,vz:()=>a,wV:()=>o});var r=n(230),s=n(5772);function a(){return(0,r.A)({endpoint:s.b.auth.login,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function i(){return(0,r.A)({endpoint:s.b.auth.signup,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function u(){return(0,r.A)({endpoint:s.b.auth.logout,method:"POST",invalidateKeys:[{queryKey:["session"]}]})}function o(){return(0,r.A)({endpoint:s.b.auth.session,method:"GET",queryKey:["session"]})}},3405:(e,t,n)=>{Promise.resolve().then(n.bind(n,12))},5772:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});let r={auth:{login:"/auth/breeder/login",logout:"/auth/breeder/logout",signup:"/auth/breeder/signup",session:"/auth/session"},user:{currentUser:"/users/profile"},birds:{all:"/birds",create:"/birds",update:e=>"/birds/".concat(e)},events:{all:"/events",byId:e=>"/events/".concat(e),more:e=>"/events/".concat(e,"/more")},eventInventory:{create:"/event-inventory",getmyevents:"/event-inventory/my-events"},payment:{capture:"/payments/capture"}}},6219:(e,t,n)=>{"use strict";n.d(t,{AuthProvider:()=>o});var r=n(13),s=n(6662),a=n(983),i=n(9828),u=n(3098);function o(e){let{children:t,requireAuth:n=!1,redirectTo:o="/login"}=e,l=(0,a.useRouter)(),{user:d,isAuthenticated:c,isLoading:h,setUser:v}=(0,i.n)(),{data:m,isError:p,isPending:f}=(0,u.wV)();return((0,s.useEffect)(()=>{f||((null==m?void 0:m.data)?v(m.data):i.n.getState().setLoading(!1))},[m,f,v]),(0,s.useEffect)(()=>{f||h||!n||c||l.push(o)},[n,c,f,h,l,o]),f||h)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):n&&!c?null:(0,r.jsx)(r.Fragment,{children:t})}},9828:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});let r=(0,n(9568).v)()((e,t)=>({user:null,isAuthenticated:!1,isLoading:!0,setUser:t=>e({user:t,isAuthenticated:!!t,isLoading:!1}),clearAuth:()=>e({user:null,isAuthenticated:!1,isLoading:!1}),setLoading:t=>e({isLoading:t})}))}},e=>{e.O(0,[46,616,1,540,358],()=>e(e.s=3405)),_N_E=e.O()}]);